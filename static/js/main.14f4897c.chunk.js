(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(7),c=n.n(a),i=(n(14),n(6),n(1));function l(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),o=n[0],a=n[1];return Object(r.useEffect)((function(){function t(t){t.key===e&&a(!0)}var n=function(t){t.key===e&&a(!1)};return window.addEventListener("keydown",t),window.addEventListener("keyup",n),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}}),[e]),o}var u,s,f=n(8),h=n(2);function v(e,t){for(var n=[],r=0;r<t;r++)n[r]=m(e);return n}function m(e){for(var t=[],n=0;n<e;n++)t[n]=g();return t}function g(){return{color:"white",status:u.EMPTY}}function E(e,t,n,r,o,a){for(var c=v(o,a),i=e.positions[t%e.positions.length],l=0;l<i.length;l++)for(var f=0;f<i[l].length;f++){if(1===i[l][f]){var h=l+n,m=f+r;if(h>=c.length||m>=c[l].length)return{kind:s.FAILURE,gridState:c};c[h][m]={color:e.color||"1",status:u.FULL}}}return{kind:s.SUCCESS,gridState:c}}function d(e,t){for(var n=[],r=0;r<e.length;r++){n[r]=Object(h.a)(t[r]);for(var o=0;o<e[r].length;o++)e[r][o].status!==u.EMPTY&&(n[r][o]=Object(f.a)({},e[r][o]))}return n}function p(e){for(var t=0;t<e.length;t++)if(e[t].status===u.EMPTY)return!1;return!0}function b(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r].status!==u.EMPTY){if(n===t.length-1)return console.log("canShapeMoveDown1Step: no! shape is at the bottom"),!1;if(t[n+1][r].status!==u.EMPTY)return console.log("canShapeMoveDown1Step: no! there's another shape in the way"),!1}return!0}function w(e){return o.a.createElement("div",{className:"Score"},o.a.createElement("div",null,"Score: ",e.score),o.a.createElement("div",null,"Level: ",e.level))}function S(e){var t=e.rotateShape,n=e.moveLeft,r=e.moveDown,a=e.moveRight;return o.a.createElement("div",{className:"Controls"},o.a.createElement("div",{className:"Controls-TopRow"},o.a.createElement("button",{onClick:function(){return t()}},o.a.createElement("span",{role:"img","aria-label":"rotate arrow button (counter clockwise)"},"\ud83d\udd04"))),o.a.createElement("div",{className:"Controls-BottomRow"},o.a.createElement("button",{onClick:function(){return n()}},o.a.createElement("span",{role:"img","aria-label":"left arrow button"},"\u2b05\ufe0f")),o.a.createElement("button",{onClick:function(){return r()}},o.a.createElement("span",{role:"img","aria-label":"down arrow button"},"\u2b07\ufe0f")),o.a.createElement("button",{onClick:function(){return a()}},o.a.createElement("span",{role:"img","aria-label":"right arrow button"},"\u27a1\ufe0f"))))}function O(e){var t=e.width,n=e.height,a=e.shapes,c=e.level,f=Object(r.useState)(!0),g=Object(i.a)(f,2),O=g[0],j=g[1],k=Object(r.useState)(0),M=Object(i.a)(k,2),C=M[0],T=M[1],L=Object(r.useState)(v(t,n)),y=Object(i.a)(L,2),R=y[0],P=y[1],Y=Object(r.useState)(0),U=Object(i.a)(Y,2),A=U[0],N=U[1],F=Object(r.useState)(0),I=Object(i.a)(F,2),D=I[0],B=I[1],V=Object(r.useState)(0),W=Object(i.a)(V,2),x=W[0],G=W[1],J=Object(r.useState)(Math.floor(t/2-1)),_=Object(i.a)(J,2),q=_[0],z=_[1],H=E(a[A],D,x,q,t,n),$=H.gridState;function K(){if(!1!==b($,R))console.log("Moving active shape down."),G(x+1);else{console.log("Active shape CAN'T move down 1 step!");var e=d($,R);if(function(e){for(var t=e.length-1;t>=0;t--)if(p(e[t]))return!0;return!1}(e)){var n=function(e){for(var t=[],n=0,r=0;r<e.length;r++)p(e[r])?(n++,t.unshift(m(e[r].length))):t.push(Object(h.a)(e[r]));return{completeRowCount:n,grid:t}}(e);e=n.grid,T(C+10*n.completeRowCount)}P(e);var r=A+1;r<a.length?(N(r),G(0),z(Math.floor(t/2-1)),B(0)):(console.log("Done! out of shapes."),j(!1))}}H.kind===s.FAILURE&&console.error("Result.FAILURE detected! TODO: handle it!!"),function(e,t){var n=Object(r.useRef)((function(){}));Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){K()}),O?1e3:null);var Q=l("ArrowLeft"),X=l("ArrowRight"),Z=l("ArrowUp"),ee=l("ArrowDown");function te(){console.log("MOVE LEFT!"),function(e,t){for(var n=0;n<e.length;n++)if(e[n][0].status!==u.EMPTY)return!1;for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)if(e[r][o].status!==u.EMPTY&&t[r][o-1].status!==u.EMPTY)return!1;return!0}($,R)&&z(q-1)}function ne(){console.log("MOVE RIGHT!"),function(e,t){for(var n=0;n<e.length;n++){var r=e[n].length-1;if(e[n][r].status!==u.EMPTY)return!1}for(var o=0;o<e.length;o++)for(var a=0;a<e[o].length;a++)if(e[o][a].status!==u.EMPTY&&t[o][a+1].status!==u.EMPTY)return!1;return!0}($,R)&&z(q+1)}function re(){console.log("Up key pressed - change shape position!");var e=D+1,r=E(a[A],e,x,q,t,n);r.kind===s.SUCCESS?!1===function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r].status!==u.EMPTY&&t[n][r].status!==u.EMPTY)return!0;return!1}(r.gridState,R)?(console.log("Rotated shape does not collide with any existing active cells!"),B(e)):console.log("Can't rotate the shape in this direction: collision!"):console.log("Can't rotate the shape in this direction: off grid!")}function oe(){console.log("MOVE DOWN!"),b($,R)&&G(x+1)}Object(r.useEffect)((function(){Q&&te()}),[Q]),Object(r.useEffect)((function(){X&&ne()}),[X]),Object(r.useEffect)((function(){Z&&re()}),[Z]),Object(r.useEffect)((function(){ee&&oe()}),[ee]);var ae=d($,R);return o.a.createElement("div",{className:"Tetris"},o.a.createElement("div",{className:"Grid"},ae.map((function(e,t){return o.a.createElement("div",{key:"row".concat(t),className:"row"},e.map((function(e,n){return o.a.createElement("div",{key:"row".concat(t,"-cell").concat(n),className:"cell",style:{backgroundColor:e.color||"white"}})})))}))),o.a.createElement(w,{level:c,score:C}),o.a.createElement(S,{rotateShape:re,moveLeft:te,moveDown:oe,moveRight:ne}))}!function(e){e[e.EMPTY=0]="EMPTY",e[e.FULL=1]="FULL"}(u||(u={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE"}(s||(s={}));var j=[function(){return{name:"square",color:"red",positions:[[[1,1],[1,1]]]}},function(){return{name:"line",color:"blue",positions:[[[1],[1],[1],[1]],[[1,1,1,1]]]}},function(){return{name:"hockeyStick",positions:[[[0,0,1],[1,1,1]],[[1,1],[0,1],[0,1]],[[1,1,1],[1,0,0]],[[1,0],[1,0],[1,1]]]}},function(){return{name:"sShape",positions:[[[0,1,1],[1,1,0]],[[1,0],[1,1],[0,1]]]}},function(){return{name:"jShape",positions:[[[1,1,1],[0,0,1]],[[1,1],[1,0],[1,0]],[[1,0,0],[1,1,1]],[[0,1],[0,1],[1,1]]]}},function(){return{name:"zShape",positions:[[[1,1,0],[0,1,1]],[[0,1],[1,1],[1,0]]]}},function(){return{name:"tShape",positions:[[[0,1,0],[1,1,1]],[[0,1],[1,1],[0,1]],[[1,1,1],[0,1,0]],[[1,0],[1,1],[1,0]]]}}];var k=["blue","green","orange","red","pink","lightgray"];function M(e){for(var t=[],n=0;n<e;n++){var r=j[Math.floor(Math.random()*j.length)](),o=k[Math.floor(Math.random()*k.length)];r.color=o,t.push(r)}return t}function C(){return o.a.createElement("footer",null,o.a.createElement("a",{href:"https://github.com/blefebvre/react-tetris",target:"_blank"},"react-tetris")," ","was made by"," ",o.a.createElement("a",{href:"https://twitter.com/brucelefebvre",target:"_blank"},"@brucelefebvre"))}function T(){return o.a.createElement("div",{className:"App"},o.a.createElement(O,{level:1,width:10,height:15,shapes:M(30)}),o.a.createElement(C,null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,n){},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.14f4897c.chunk.js.map