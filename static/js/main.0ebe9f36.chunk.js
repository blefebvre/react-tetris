(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(7),c=n.n(a),i=(n(14),n(6),n(1));function s(e){var t=Object(o.useState)(!1),n=Object(i.a)(t,2),r=n[0],a=n[1];return Object(o.useEffect)((function(){function t(t){t.key===e&&a(!0)}var n=function(t){t.key===e&&a(!1)};return window.addEventListener("keydown",t),window.addEventListener("keyup",n),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}}),[e]),r}var u,l,f=n(8),h=n(2);function v(e,t){for(var n=[],o=0;o<t;o++)n[o]=g(e);return n}function g(e){for(var t=[],n=0;n<e;n++)t[n]=E();return t}function E(){return{color:"white",status:u.EMPTY}}function d(e,t,n,o,r,a){for(var c=v(r,a),i=e.positions[t%e.positions.length],s=0;s<i.length;s++)for(var f=0;f<i[s].length;f++){if(1===i[s][f]){var h=s+n,g=f+o;if(h>=c.length||g>=c[s].length)return{kind:l.FAILURE,gridState:c};c[h][g]={color:e.color||"1",status:u.FULL}}}return{kind:l.SUCCESS,gridState:c}}function m(e,t){for(var n=[],o=0;o<e.length;o++){n[o]=Object(h.a)(t[o]);for(var r=0;r<e[o].length;r++)e[o][r].status!==u.EMPTY&&(n[o][r]=Object(f.a)({},e[o][r]))}return n}function p(e){for(var t=0;t<e.length;t++)if(e[t].status===u.EMPTY)return!1;return!0}function w(e,t){for(var n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)if(e[n][o].status!==u.EMPTY){if(n===t.length-1)return console.log("canShapeMoveDown1Step: no! shape is at the bottom"),!1;if(t[n+1][o].status!==u.EMPTY)return console.log("canShapeMoveDown1Step: no! there's another shape in the way"),!1}return!0}function b(e){var t=e.width,n=e.height,a=e.shapes,c=Object(o.useState)(!0),f=Object(i.a)(c,2),E=f[0],b=f[1],S=Object(o.useState)(v(t,n)),O=Object(i.a)(S,2),M=O[0],j=O[1],k=Object(o.useState)(0),T=Object(i.a)(k,2),C=T[0],L=T[1],y=Object(o.useState)(0),P=Object(i.a)(y,2),Y=P[0],U=P[1],A=Object(o.useState)(0),R=Object(i.a)(A,2),N=R[0],F=R[1],I=Object(o.useState)(Math.floor(t/2-1)),D=Object(i.a)(I,2),B=D[0],V=D[1],W=d(a[C],Y,N,B,t,n),x=W.gridState;function G(){if(!1!==w(x,M))console.log("Moving active shape down."),F(N+1);else{console.log("Active shape CAN'T move down 1 step!");var e=m(x,M);(function(e){for(var t=e.length-1;t>=0;t--)if(p(e[t]))return!0;return!1})(e)&&(e=function(e){for(var t=[],n=0;n<e.length;n++)p(e[n])?t.unshift(g(e[n].length)):t.push(Object(h.a)(e[n]));return t}(e)),j(e);var n=C+1;n<a.length?(L(n),F(0),V(Math.floor(t/2-1)),U(0)):(console.log("Done! out of shapes."),b(!1))}}W.kind===l.FAILURE&&console.error("Result.FAILURE detected! TODO: handle it!!"),function(e,t){var n=Object(o.useRef)((function(){}));Object(o.useEffect)((function(){n.current=e}),[e]),Object(o.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){G()}),E?1e3:null);var J=s("ArrowLeft"),q=s("ArrowRight"),z=s("ArrowUp"),H=s("ArrowDown");function $(){console.log("MOVE LEFT!"),function(e,t){for(var n=0;n<e.length;n++)if(e[n][0].status!==u.EMPTY)return!1;for(var o=0;o<e.length;o++)for(var r=0;r<e[o].length;r++)if(e[o][r].status!==u.EMPTY&&t[o][r-1].status!==u.EMPTY)return!1;return!0}(x,M)&&V(B-1)}function K(){console.log("MOVE RIGHT!"),function(e,t){for(var n=0;n<e.length;n++){var o=e[n].length-1;if(e[n][o].status!==u.EMPTY)return!1}for(var r=0;r<e.length;r++)for(var a=0;a<e[r].length;a++)if(e[r][a].status!==u.EMPTY&&t[r][a+1].status!==u.EMPTY)return!1;return!0}(x,M)&&V(B+1)}function Q(){console.log("Up key pressed - change shape position!");var e=Y+1,o=d(a[C],e,N,B,t,n);o.kind===l.SUCCESS?!1===function(e,t){for(var n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)if(e[n][o].status!==u.EMPTY&&t[n][o].status!==u.EMPTY)return!0;return!1}(o.gridState,M)?(console.log("Rotated shape does not collide with any existing active cells!"),U(e)):console.log("Can't rotate the shape in this direction: collision!"):console.log("Can't rotate the shape in this direction: off grid!")}function X(){console.log("MOVE DOWN!"),w(x,M)&&F(N+1)}Object(o.useEffect)((function(){J&&$()}),[J]),Object(o.useEffect)((function(){q&&K()}),[q]),Object(o.useEffect)((function(){z&&Q()}),[z]),Object(o.useEffect)((function(){H&&X()}),[H]);var Z=m(x,M);return r.a.createElement("div",{className:"Tetris"},r.a.createElement("div",{className:"Grid"},Z.map((function(e,t){return r.a.createElement("div",{key:"row".concat(t),className:"row"},e.map((function(e,n){return r.a.createElement("div",{key:"row".concat(t,"-cell").concat(n),className:"cell",style:{backgroundColor:e.color||"white"}})})))}))),r.a.createElement("div",{className:"Controls"},r.a.createElement("div",{className:"Controls-TopRow"},r.a.createElement("button",{onClick:function(){return Q()}},r.a.createElement("span",{role:"img","aria-label":"rotate arrow button (counter clockwise)"},"\ud83d\udd04"))),r.a.createElement("div",{className:"Controls-BottomRow"},r.a.createElement("button",{onClick:function(){return $()}},r.a.createElement("span",{role:"img","aria-label":"left arrow button"},"\u23ea")),r.a.createElement("button",{onClick:function(){return X()}},r.a.createElement("span",{role:"img","aria-label":"down arrow button"},"\u23ec")),r.a.createElement("button",{onClick:function(){return K()}},r.a.createElement("span",{role:"img","aria-label":"right arrow button"},"\u23e9")))))}!function(e){e[e.EMPTY=0]="EMPTY",e[e.FULL=1]="FULL"}(u||(u={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE"}(l||(l={}));var S=[function(){return{name:"square",color:"red",positions:[[[1,1],[1,1]]]}},function(){return{name:"line",color:"blue",positions:[[[1],[1],[1],[1]],[[1,1,1,1]]]}},function(){return{name:"hockeyStick",positions:[[[0,0,1],[1,1,1]],[[1,1],[0,1],[0,1]],[[1,1,1],[1,0,0]],[[1,0],[1,0],[1,1]]]}},function(){return{name:"sShape",positions:[[[0,1,1],[1,1,0]],[[1,0],[1,1],[0,1]]]}},function(){return{name:"jShape",positions:[[[1,1,1],[0,0,1]],[[1,1],[1,0],[1,0]],[[1,0,0],[1,1,1]],[[0,1],[0,1],[1,1]]]}},function(){return{name:"zShape",positions:[[[1,1,0],[0,1,1]],[[0,1],[1,1],[1,0]]]}},function(){return{name:"tShape",positions:[[[0,1,0],[1,1,1]],[[0,1],[1,1],[0,1]],[[1,1,1],[0,1,0]],[[1,0],[1,1],[1,0]]]}}];var O=["blue","green","yellow","red","pink"];function M(e){for(var t=[],n=0;n<e;n++){var o=S[Math.floor(Math.random()*S.length)](),r=O[Math.floor(Math.random()*O.length)];o.color=r,t.push(o)}return t}function j(){return r.a.createElement("div",{className:"App"},r.a.createElement(b,{width:10,height:15,shapes:M(30)}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,n){},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.0ebe9f36.chunk.js.map