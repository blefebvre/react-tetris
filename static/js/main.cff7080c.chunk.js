(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(7),c=n.n(a),i=(n(14),n(6),n(1));function u(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),o=n[0],a=n[1];return Object(r.useEffect)((function(){function t(t){t.key===e&&a(!0)}var n=function(t){t.key===e&&a(!1)};return window.addEventListener("keydown",t),window.addEventListener("keyup",n),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}}),[e]),o}var s,l,f=n(8),h=n(2);function v(e,t){for(var n=[],r=0;r<t;r++)n[r]=g(e);return n}function g(e){for(var t=[],n=0;n<e;n++)t[n]=E();return t}function E(){return{color:"white",status:s.EMPTY}}function m(e,t,n,r,o,a){for(var c=v(o,a),i=e.positions[t%e.positions.length],u=0;u<i.length;u++)for(var f=0;f<i[u].length;f++){if(1===i[u][f]){var h=u+n,g=f+r;if(h>=c.length||g>=c[u].length)return{kind:l.FAILURE,gridState:c};c[h][g]={color:e.color||"1",status:s.FULL}}}return{kind:l.SUCCESS,gridState:c}}function d(e,t){for(var n=[],r=0;r<e.length;r++){n[r]=Object(h.a)(t[r]);for(var o=0;o<e[r].length;o++)e[r][o].status!==s.EMPTY&&(n[r][o]=Object(f.a)({},e[r][o]))}return n}function p(e){for(var t=0;t<e.length;t++)if(e[t].status===s.EMPTY)return!1;return!0}function b(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r].status!==s.EMPTY){if(n===t.length-1)return console.log("canShapeMoveDown1Step: no! shape is at the bottom"),!1;if(t[n+1][r].status!==s.EMPTY)return console.log("canShapeMoveDown1Step: no! there's another shape in the way"),!1}return!0}function w(e){var t=e.width,n=e.height,a=e.shapes,c=Object(r.useState)(!0),f=Object(i.a)(c,2),E=f[0],w=f[1],S=Object(r.useState)(v(t,n)),O=Object(i.a)(S,2),k=O[0],M=O[1],j=Object(r.useState)(0),T=Object(i.a)(j,2),C=T[0],y=T[1],L=Object(r.useState)(0),P=Object(i.a)(L,2),Y=P[0],U=P[1],A=Object(r.useState)(0),R=Object(i.a)(A,2),N=R[0],F=R[1],I=Object(r.useState)(Math.floor(t/2-1)),D=Object(i.a)(I,2),B=D[0],V=D[1],W=m(a[C],Y,N,B,t,n),x=W.gridState;function G(){if(!1!==b(x,k))console.log("Moving active shape down."),F(N+1);else{console.log("Active shape CAN'T move down 1 step!");var e=d(x,k);(function(e){for(var t=e.length-1;t>=0;t--)if(p(e[t]))return!0;return!1})(e)&&(e=function(e){for(var t=[],n=0;n<e.length;n++)p(e[n])?t.unshift(g(e[n].length)):t.push(Object(h.a)(e[n]));return t}(e)),M(e);var n=C+1;n<a.length?(y(n),F(0),V(Math.floor(t/2-1)),U(0)):(console.log("Done! out of shapes."),w(!1))}}W.kind===l.FAILURE&&console.error("Result.FAILURE detected! TODO: handle it!!"),function(e,t){var n=Object(r.useRef)((function(){}));Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){G()}),E?1e3:null);var J=u("ArrowLeft"),_=u("ArrowRight"),q=u("ArrowUp"),z=u("ArrowDown");function H(){console.log("MOVE LEFT!"),function(e,t){for(var n=0;n<e.length;n++)if(e[n][0].status!==s.EMPTY)return!1;for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)if(e[r][o].status!==s.EMPTY&&t[r][o-1].status!==s.EMPTY)return!1;return!0}(x,k)&&V(B-1)}function $(){console.log("MOVE RIGHT!"),function(e,t){for(var n=0;n<e.length;n++){var r=e[n].length-1;if(e[n][r].status!==s.EMPTY)return!1}for(var o=0;o<e.length;o++)for(var a=0;a<e[o].length;a++)if(e[o][a].status!==s.EMPTY&&t[o][a+1].status!==s.EMPTY)return!1;return!0}(x,k)&&V(B+1)}function K(){console.log("Up key pressed - change shape position!");var e=Y+1,r=m(a[C],e,N,B,t,n);r.kind===l.SUCCESS?!1===function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r].status!==s.EMPTY&&t[n][r].status!==s.EMPTY)return!0;return!1}(r.gridState,k)?(console.log("Rotated shape does not collide with any existing active cells!"),U(e)):console.log("Can't rotate the shape in this direction: collision!"):console.log("Can't rotate the shape in this direction: off grid!")}function Q(){console.log("MOVE DOWN!"),b(x,k)&&F(N+1)}Object(r.useEffect)((function(){J&&H()}),[J]),Object(r.useEffect)((function(){_&&$()}),[_]),Object(r.useEffect)((function(){q&&K()}),[q]),Object(r.useEffect)((function(){z&&Q()}),[z]);var X=d(x,k);return o.a.createElement("div",{className:"Tetris"},o.a.createElement("div",{className:"Grid"},X.map((function(e,t){return o.a.createElement("div",{key:"row".concat(t),className:"row"},e.map((function(e,n){return o.a.createElement("div",{key:"row".concat(t,"-cell").concat(n),className:"cell",style:{backgroundColor:e.color||"white"}})})))}))),o.a.createElement("div",{className:"Controls"},o.a.createElement("div",{className:"Controls-TopRow"},o.a.createElement("button",{onClick:function(){return K()}},o.a.createElement("span",{role:"img","aria-label":"rotate arrow button (counter clockwise)"},"\ud83d\udd04"))),o.a.createElement("div",{className:"Controls-BottomRow"},o.a.createElement("button",{onClick:function(){return H()}},o.a.createElement("span",{role:"img","aria-label":"left arrow button"},"\u23ea")),o.a.createElement("button",{onClick:function(){return Q()}},o.a.createElement("span",{role:"img","aria-label":"down arrow button"},"\u23ec")),o.a.createElement("button",{onClick:function(){return $()}},o.a.createElement("span",{role:"img","aria-label":"right arrow button"},"\u23e9")))))}!function(e){e[e.EMPTY=0]="EMPTY",e[e.FULL=1]="FULL"}(s||(s={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE"}(l||(l={}));var S=[function(){return{name:"square",color:"red",positions:[[[1,1],[1,1]]]}},function(){return{name:"line",color:"blue",positions:[[[1],[1],[1],[1]],[[1,1,1,1]]]}},function(){return{name:"hockeyStick",positions:[[[0,0,1],[1,1,1]],[[1,1],[0,1],[0,1]],[[1,1,1],[1,0,0]],[[1,0],[1,0],[1,1]]]}},function(){return{name:"sShape",positions:[[[0,1,1],[1,1,0]],[[1,0],[1,1],[0,1]]]}},function(){return{name:"jShape",positions:[[[1,1,1],[0,0,1]],[[1,1],[1,0],[1,0]],[[1,0,0],[1,1,1]],[[0,1],[0,1],[1,1]]]}},function(){return{name:"zShape",positions:[[[1,1,0],[0,1,1]],[[0,1],[1,1],[1,0]]]}},function(){return{name:"tShape",positions:[[[0,1,0],[1,1,1]],[[0,1],[1,1],[0,1]],[[1,1,1],[0,1,0]],[[1,0],[1,1],[1,0]]]}}];var O=["blue","green","yellow","red","pink"];function k(e){for(var t=[],n=0;n<e;n++){var r=S[Math.floor(Math.random()*S.length)](),o=O[Math.floor(Math.random()*O.length)];r.color=o,t.push(r)}return t}function M(){return o.a.createElement("footer",null,o.a.createElement("a",{href:"https://github.com/blefebvre/react-tetris",target:"_blank"},"react-tetris")," ","was made by"," ",o.a.createElement("a",{href:"https://twitter.com/brucelefebvre",target:"_blank"},"@brucelefebvre"))}function j(){return o.a.createElement("div",{className:"App"},o.a.createElement(w,{width:10,height:15,shapes:k(30)}),o.a.createElement(M,null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,n){},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.cff7080c.chunk.js.map